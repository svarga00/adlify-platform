<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1e1b4b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Adlify</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    
    <!-- Onboarding Components Styles -->
    <link rel="stylesheet" href="../modules/onboarding/components/PlatformSelector.css">
    <link rel="stylesheet" href="../modules/onboarding/components/PackageCalculator.css">
    <link rel="stylesheet" href="../modules/onboarding/components/AccountHealthCheck.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#f97316',
                        'primary-dark': '#ea580c',
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --vh: 1vh;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Inter', sans-serif; 
            background: #f8fafc;
            overscroll-behavior-y: contain;
        }
        
        /* =====================================================
           APP LAYOUT
           ===================================================== */
        .app {
            display: flex;
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100);
            overflow: hidden;
        }
        
        /* =====================================================
           SIDEBAR
           ===================================================== */
        .sidebar {
            width: 250px;
            background: linear-gradient(180deg, #1e1b4b 0%, #0f172a 100%);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            transition: transform 0.3s ease;
            z-index: 50;
        }
        
        .sidebar-logo {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 38px;
            height: 38px;
            background: linear-gradient(135deg, #f97316 0%, #ec4899 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-icon svg {
            width: 20px;
            height: 20px;
            color: white;
        }
        
        .logo-text {
            font-size: 20px;
            font-weight: 700;
            color: white;
            letter-spacing: -0.5px;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 8px 12px;
            overflow-y: auto;
        }
        
        .nav-section {
            margin-bottom: 20px;
        }
        
        .nav-label {
            font-size: 10px;
            font-weight: 700;
            color: #6366f1;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 12px 12px 8px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-radius: 8px;
            color: rgba(255,255,255,0.6);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s ease;
            text-decoration: none;
            border: 1px solid transparent;
            margin-bottom: 2px;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.9);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, rgba(249,115,22,0.2), rgba(236,72,153,0.1));
            color: #fff;
            border-color: rgba(249,115,22,0.3);
        }
        
        .nav-item.active svg {
            color: #f97316;
        }
        
        .nav-item svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }
        
        .nav-item-text {
            flex: 1;
        }
        
        .nav-badge {
            margin-left: auto;
            background: linear-gradient(135deg, #f97316, #ec4899);
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid rgba(255,255,255,0.05);
        }
        
        .sidebar-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: rgba(255,255,255,0.5);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
        }
        
        .status-dot.disconnected {
            background: #ef4444;
        }
        
        /* =====================================================
           MAIN AREA
           ===================================================== */
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* =====================================================
           HEADER
           ===================================================== */
        .header {
            height: 64px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            padding: 0 24px;
            gap: 16px;
            flex-shrink: 0;
        }
        
        .mobile-menu-btn {
            display: none;
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 8px;
            padding: 8px;
            flex-shrink: 0;
        }
        
        .mobile-menu-btn:hover {
            background: #f1f5f9;
        }
        
        .mobile-menu-btn span {
            display: block;
            width: 20px;
            height: 2px;
            background: #64748b;
            margin: 5px auto;
            border-radius: 2px;
            transition: all 0.3s;
        }
        
        .mobile-menu-btn.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .mobile-menu-btn.active span:nth-child(2) {
            opacity: 0;
        }
        .mobile-menu-btn.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }
        
        .header-title {
            font-size: 18px;
            font-weight: 600;
            color: #0f172a;
            white-space: nowrap;
        }
        
        .header-search {
            flex: 1;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: #f1f5f9;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .search-box:hover {
            background: #e2e8f0;
        }
        
        .search-box svg {
            width: 18px;
            height: 18px;
            color: #94a3b8;
        }
        
        .search-box span {
            color: #94a3b8;
            font-size: 14px;
        }
        
        .search-box kbd {
            margin-left: auto;
            padding: 3px 8px;
            background: white;
            border-radius: 6px;
            font-size: 12px;
            color: #94a3b8;
            font-family: inherit;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: transparent;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
            position: relative;
            transition: all 0.15s;
        }
        
        .header-btn:hover {
            background: #f1f5f9;
            color: #0f172a;
        }
        
        .header-btn svg {
            width: 20px;
            height: 20px;
        }
        
        .header-btn .badge {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            border: 2px solid white;
        }
        
        .header-divider {
            width: 1px;
            height: 32px;
            background: #e2e8f0;
            margin: 0 8px;
        }
        
        .header-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 6px 12px 6px 6px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .header-profile:hover {
            background: #f1f5f9;
        }
        
        .profile-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
        }
        
        .profile-info {
            text-align: left;
        }
        
        .profile-name {
            font-size: 14px;
            font-weight: 600;
            color: #0f172a;
        }
        
        .profile-role {
            font-size: 12px;
            color: #64748b;
        }
        
        .profile-chevron {
            color: #94a3b8;
        }
        
        .profile-chevron svg {
            width: 16px;
            height: 16px;
        }
        
        /* =====================================================
           CONTENT
           ===================================================== */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: #f8fafc;
        }
        
        /* =====================================================
           OVERLAY
           ===================================================== */
        .sidebar-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 40;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }
        
        /* =====================================================
           RESPONSIVE
           ===================================================== */
        @media (max-width: 1023px) {
            .mobile-menu-btn {
                display: flex;
            }
            
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                transform: translateX(-100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .header-search {
                display: none;
            }
            
            .profile-info {
                display: none;
            }
            
            .header-divider {
                display: none;
            }
            
            .header {
                padding: 0 16px;
            }
        }
        
        @media (max-width: 640px) {
            .content {
                padding: 16px;
            }
            
            .header-title {
                font-size: 16px;
            }
        }
        
        /* =====================================================
           UTILITIES
           ===================================================== */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        
        .sidebar-nav::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
        
        /* Safe area for notch devices */
        @supports (padding: max(0px)) {
            .sidebar {
                padding-top: max(0px, env(safe-area-inset-top));
                padding-bottom: max(0px, env(safe-area-inset-bottom));
            }
        }
        
        /* Touch friendly */
        * { -webkit-tap-highlight-color: transparent; }
        
        /* Responsive tables */
        @media (max-width: 767px) {
            table.responsive-table { display: block; }
            table.responsive-table thead { display: none; }
            table.responsive-table tbody { display: flex; flex-direction: column; gap: 12px; }
            table.responsive-table tr { display: block; background: white; border-radius: 12px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
            table.responsive-table td { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border: none !important; border-bottom: 1px solid #f1f5f9 !important; }
            table.responsive-table td:last-child { border-bottom: none !important; }
            table.responsive-table td::before { content: attr(data-label); font-weight: 600; color: #64748b; flex-shrink: 0; margin-right: 12px; }
        }
    </style>
</head>
<body>
    <!-- Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <div class="app" id="app">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                    </svg>
                </div>
                <span class="logo-text">Adlify</span>
            </div>
            
            <nav class="sidebar-nav">
                <!-- HLAVN√â -->
                <div class="nav-section">
                    <div class="nav-label">Hlavn√©</div>
                    
                    <a class="nav-item active" href="#dashboard" data-route="dashboard">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/>
                            <rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/>
                        </svg>
                        <span class="nav-item-text">Dashboard</span>
                    </a>
                    
                    <a class="nav-item" href="#leads" data-route="leads">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>
                        </svg>
                        <span class="nav-item-text">Leady</span>
                        <span class="nav-badge" id="badge-leads" style="display:none;"></span>
                    </a>
                    
                    <a class="nav-item" href="#clients" data-route="clients">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 21h18M3 7v1a3 3 0 0 0 6 0V7m0 1a3 3 0 0 0 6 0V7m0 1a3 3 0 0 0 6 0V7H3l2-4h14l2 4M5 21V10.85M19 21V10.85"/>
                        </svg>
                        <span class="nav-item-text">Klienti</span>
                    </a>
                    
                    <a class="nav-item" href="#projects" data-route="projects">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                        </svg>
                        <span class="nav-item-text">Projekty</span>
                    </a>
                    
                    <a class="nav-item" href="#campaigns" data-route="campaigns">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m3 11 18-5v12L3 14v-3z"/><path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"/>
                        </svg>
                        <span class="nav-item-text">Kampane</span>
                    </a>
                    
                    <a class="nav-item" href="#messages" data-route="messages">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                            <polyline points="22,6 12,13 2,6"/>
                        </svg>
                        <span class="nav-item-text">Spr√°vy</span>
                        <span class="nav-badge" id="badge-messages" style="display:none;"></span>
                    </a>
                    
                    <a class="nav-item" href="#tasks" data-route="tasks">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                        </svg>
                        <span class="nav-item-text">√ölohy</span>
                    </a>
                    
                    <a class="nav-item" href="#tickets" data-route="tickets">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M2 12h5M17 12h5M12 2v5M12 17v5M4.93 4.93l3.54 3.54M15.54 15.54l3.54 3.54M4.93 19.07l3.54-3.54M15.54 8.46l3.54-3.54"/>
                        </svg>
                        <span class="nav-item-text">Tickety</span>
                    </a>
                    
                    <a class="nav-item" href="#billing" data-route="billing">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/>
                        </svg>
                        <span class="nav-item-text">Faktur√°cia</span>
                    </a>
                </div>
                
                <!-- N√ÅSTROJE -->
                <div class="nav-section">
                    <div class="nav-label">N√°stroje</div>
                    
                    <a class="nav-item" href="#onboarding" data-route="onboarding">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                            <rect x="8" y="2" width="8" height="4" rx="1"/><path d="m9 14 2 2 4-4"/>
                        </svg>
                        <span class="nav-item-text">Onboarding</span>
                    </a>
                    
                    <a class="nav-item" href="#services" data-route="services">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 7h-9M14 17H5M17 17a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM7 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"/>
                        </svg>
                        <span class="nav-item-text">Slu≈æby & Bal√≠ƒçky</span>
                    </a>
                    
                    <a class="nav-item" href="#reporting" data-route="reporting">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/>
                        </svg>
                        <span class="nav-item-text">Reporty</span>
                    </a>
                    
                    <a class="nav-item" href="#calendar" data-route="calendar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                        <span class="nav-item-text">Kalend√°r</span>
                    </a>
                    
                    <a class="nav-item" href="#templates" data-route="templates">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        <span class="nav-item-text">≈†abl√≥ny</span>
                    </a>
                    
                    <a class="nav-item" href="#documents" data-route="documents">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                            <line x1="12" y1="11" x2="12" y2="17"/><line x1="9" y1="14" x2="15" y2="14"/>
                        </svg>
                        <span class="nav-item-text">Dokumenty</span>
                    </a>
                    
                    <a class="nav-item" href="#keywords" data-route="keywords">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
                        </svg>
                        <span class="nav-item-text">Keywords</span>
                    </a>
                    
                    <a class="nav-item" href="#automations" data-route="automations">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                        </svg>
                        <span class="nav-item-text">Automatiz√°cie</span>
                    </a>
                </div>
                
                <!-- SYST√âM -->
                <div class="nav-section">
                    <div class="nav-label">Syst√©m</div>
                    
                    <a class="nav-item" href="#settings" data-route="settings">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                        </svg>
                        <span class="nav-item-text">Nastavenia</span>
                    </a>
                    
                    <a class="nav-item" href="#integrations" data-route="integrations">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                        </svg>
                        <span class="nav-item-text">Integr√°cie</span>
                    </a>
                    
                    <a class="nav-item" href="#team" data-route="team">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                        </svg>
                        <span class="nav-item-text">T√≠m</span>
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="sidebar-status" id="connection-status">
                    <span class="status-dot"></span>
                    Prip√°jam...
                </div>
            </div>
        </aside>
        
        <!-- MAIN -->
        <div class="main">
            <!-- HEADER -->
            <header class="header">
                <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Menu">
                    <span></span><span></span><span></span>
                </button>
                
                <h1 class="header-title" id="page-title">Dashboard</h1>
                
                <div class="header-search">
                    <div class="search-box" onclick="App.openSearch && App.openSearch()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
                        </svg>
                        <span>Hƒæada≈•...</span>
                        <kbd>‚åòK</kbd>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="header-btn" title="Notifik√°cie" id="notifications-btn" onclick="Notifications.toggle()">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
  <span class="badge" id="notifications-badge" style="display:none;"></span>
</button>
<div id="notifications-dropdown" class="absolute right-0 top-full mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden z-50 hidden">
  <div class="p-4 border-b border-gray-100 flex items-center justify-between">
    <span class="font-semibold">Notifik√°cie</span>
    <button onclick="Notifications.markAllRead()" class="text-xs text-orange-600 hover:underline">Oznaƒçi≈• v≈°etky ako preƒç√≠tan√©</button>
  </div>
  <div id="notifications-list" class="max-h-96 overflow-y-auto">
    <div class="p-4 text-center text-gray-400">Naƒç√≠tavam...</div>
  </div>
</div>
                
                <div class="header-divider"></div>
                
                <div class="header-profile" onclick="Router.navigate && Router.navigate('settings')">
                    <div class="profile-avatar" id="user-avatar">?</div>
                    <div class="profile-info">
                        <div class="profile-name" id="user-name">Naƒç√≠tavam...</div>
                        <div class="profile-role" id="user-role">-</div>
                    </div>
                    <div class="profile-chevron">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m6 9 6 6 6-6"/>
                        </svg>
                    </div>
                </div>
            </header>
            
            <!-- CONTENT -->
            <main class="content" id="main-content">
                <div style="display:flex;align-items:center;justify-content:center;height:200px;color:#64748b;">
                    <svg class="animate-spin" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
                    </svg>
                </div>
            </main>
        </div>
    </div>
    
    <div id="modals"></div>
    
    <!-- Core Scripts -->
    <script src="../shared/js/core/config.js"></script>
    <script src="../shared/js/core/database.js"></script>
    <script src="../shared/js/core/auth.js"></script>
    <script src="../shared/js/core/router.js"></script>
    <script src="../shared/js/core/utils.js"></script>
    <script src="../shared/js/utils/pdf-generator.js"></script>
    <script src="../shared/js/core/app.js"></script>
    <script src="../shared/js/components/notifications.js"></script>
    
    <!-- Module Scripts -->
    <script src="../modules/dashboard/dashboard.js"></script>
    <script src="../modules/leads/leads.js"></script>
    <script src="../modules/clients/clients.js"></script>
    <script src="../modules/messages/messages.js"></script>
    <script src="../modules/projects/projects.js"></script>
    <script src="../modules/campaigns/campaigns.js"></script>
    <script src="../modules/onboarding/onboarding.js"></script>
    
    <!-- Onboarding Components -->
    <script src="../modules/onboarding/components/PlatformSelector.js"></script>
    <script src="../modules/onboarding/components/PackageCalculator.js"></script>
    <script src="../modules/onboarding/components/AccountHealthCheck.js"></script>
    
    <!-- Onboarding Extension -->
    <script src="../modules/onboarding/onboarding-extension.js"></script>
    <script src="../modules/services/services.js"></script>
    <script src="../modules/billing/billing.js"></script>
    <script src="../modules/settings/settings.js"></script>
    <script src="../modules/integrations/integrations.js"></script>
    <script src="../modules/team/team.js"></script>
    <script src="../modules/tasks/tasks.js"></script>
    <script src="../modules/tickets/tickets.js"></script>
    <script src="../modules/reporting/reporting.js"></script>
    <script src="../modules/calendar/calendar.js"></script>
    <script src="../modules/templates/templates.js"></script>
    <script src="../modules/documents/documents.js"></script>
    <script src="../modules/keywords/keywords.js"></script>
    <script src="../modules/automations/automations.js"></script>
    
    <!-- Mobile Menu & UI -->
    <script>
    (function() {
        'use strict';
        
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const menuBtn = document.getElementById('mobile-menu-btn');
        
        // Fix viewport height for mobile
        function setVH() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        setVH();
        window.addEventListener('resize', setVH);
        window.addEventListener('orientationchange', () => setTimeout(setVH, 100));
        
        function toggleMenu() {
            const isOpen = sidebar.classList.toggle('open');
            overlay.classList.toggle('active', isOpen);
            menuBtn.classList.toggle('active', isOpen);
            document.body.style.overflow = isOpen ? 'hidden' : '';
        }
        
        function closeMenu() {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            menuBtn.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        menuBtn.addEventListener('click', toggleMenu);
        overlay.addEventListener('click', closeMenu);
        
        // Close on menu item click (mobile)
        sidebar.addEventListener('click', (e) => {
            if (e.target.closest('.nav-item') && window.innerWidth < 1024) {
                closeMenu();
            }
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeMenu();
        });
        
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) closeMenu();
        });
        
        // Swipe gestures
        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        }, { passive: true });
        
        document.addEventListener('touchend', (e) => {
            const deltaX = e.changedTouches[0].clientX - touchStartX;
            if (deltaX > 50 && touchStartX < 30 && !sidebar.classList.contains('open')) toggleMenu();
            if (deltaX < -50 && sidebar.classList.contains('open')) closeMenu();
        }, { passive: true });
        
        // Responsive tables
        const observer = new MutationObserver(() => {
            document.querySelectorAll('table:not(.responsive-table)').forEach(table => {
                table.classList.add('responsive-table');
                const headers = Array.from(table.querySelectorAll('thead th')).map(th => th.textContent.trim());
                table.querySelectorAll('tbody tr').forEach(row => {
                    row.querySelectorAll('td').forEach((cell, i) => {
                        if (headers[i]) cell.setAttribute('data-label', headers[i]);
                    });
                });
            });
        });
        observer.observe(document.getElementById('main-content'), { childList: true, subtree: true });
        
        // Update active menu item on route change
        window.addEventListener('hashchange', updateActiveMenu);
        updateActiveMenu();
        
        function updateActiveMenu() {
            const hash = window.location.hash.slice(1) || 'dashboard';
            const route = hash.split('?')[0].split('/')[0];
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.route === route) {
                    item.classList.add('active');
                }
            });
            
            // Update page title
            const activeItem = document.querySelector(`.nav-item[data-route="${route}"]`);
            if (activeItem) {
                const titleEl = document.getElementById('page-title');
                if (titleEl) {
                    titleEl.textContent = activeItem.querySelector('.nav-item-text')?.textContent || 'Dashboard';
                }
            }
        }
        
        console.log('üì± UI ready');
    })();
    </script>
    
    <!-- Initialize App -->
    <script>
        (async () => {
            const success = await App.init({ requireTeam: true });
            
            if (success) {
                // Update UI with user info
                const userName = Auth.profile?.full_name || Auth.user?.email || 'User';
                const userInitial = userName.charAt(0).toUpperCase();
                const roles = { owner: 'Vlastn√≠k', admin: 'Admin', employee: 'Zamestnanec' };
                
                document.getElementById('user-name').textContent = userName;
                document.getElementById('user-avatar').textContent = userInitial;
                document.getElementById('user-role').textContent = roles[Auth.getRole()] || Auth.getRole();
                
                // Update connection status
                const statusEl = document.getElementById('connection-status');
                statusEl.innerHTML = '<span class="status-dot"></span> Pripojen√©';
                
                // Initialize Notifications
                if (typeof Notifications !== 'undefined') {
                    Notifications.init();
                }
                
                // Register modules - HLAVN√â
                App.register(DashboardModule);
                App.register(LeadsModule);
                App.register(ClientsModule);
                App.register(CampaignProjectsModule);
                App.register(CampaignsModule);
                App.register(MessagesModule);
                App.register(TasksModule);
                App.register(TicketsModule);
                App.register(BillingModule);
                
                // Register modules - N√ÅSTROJE
                App.register(OnboardingModule);
                App.register(ServicesModule);
                App.register(ReportingModule);
                App.register(CalendarModule);
                App.register(TemplatesModule);
                App.register(DocumentsModule);
                App.register(KeywordResearchModule);
                App.register(AutomationsModule);
                
                // Register modules - SYST√âM
                App.register(SettingsModule);
                App.register(IntegrationsModule);
                App.register(TeamModule);
                
                // START the router
                App.start();
            }
        })();
    </script>
</body>
</html>
