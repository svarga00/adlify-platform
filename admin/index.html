<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1e1e2f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Adlify CRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Onboarding Components Styles -->
    <link rel="stylesheet" href="../modules/onboarding/components/PlatformSelector.css">
    <link rel="stylesheet" href="../modules/onboarding/components/PackageCalculator.css">
    <link rel="stylesheet" href="../modules/onboarding/components/AccountHealthCheck.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#FF6B35',
                        'secondary': '#E91E63',
                        'accent': '#9C27B0',
                        'sidebar': '#1e1e2f',
                        'sidebar-hover': '#2d2d44'
                    },
                    screens: {
                        'xs': '480px',
                        'sm': '640px',
                        'md': '768px',
                        'lg': '1024px',
                        'xl': '1280px',
                    }
                }
            }
        }
    </script>
    <style>
        /* =====================================================
           BASE STYLES
           ===================================================== */
        :root {
            --vh: 1vh;
            --sidebar-width: 256px;
        }
        
        body { 
            font-family: 'Inter', sans-serif; 
            overscroll-behavior-y: contain;
        }
        
        .gradient-bg { background: linear-gradient(135deg, #FF6B35 0%, #E91E63 50%, #9C27B0 100%); }
        .gradient-text { background: linear-gradient(135deg, #FF6B35, #E91E63, #9C27B0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .card { background: white; border-radius: 1rem; box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }
        
        /* Full height fix for mobile browsers */
        #app {
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100);
        }
        
        /* =====================================================
           NEW SIDEBAR - Icon Rail + Expanded Panel
           ===================================================== */
        .sidebar-container {
            display: flex;
            height: 100vh;
            transition: transform 0.3s ease;
        }
        
        /* Icon Rail */
        .icon-rail {
            width: 72px;
            background: linear-gradient(180deg, #1a1a2e 0%, #0f0f1a 100%);
            padding: 16px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            border-right: 1px solid rgba(255,255,255,0.05);
            flex-shrink: 0;
        }
        
        .rail-logo {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #f97316 0%, #ec4899 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 24px;
            box-shadow: 0 4px 15px rgba(249, 115, 22, 0.3);
        }
        
        .rail-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            padding: 0 12px;
            flex: 1;
            overflow-y: auto;
        }
        
        .rail-item {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 4px;
            position: relative;
            flex-shrink: 0;
        }
        
        .rail-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .rail-item.active {
            background: linear-gradient(135deg, #f97316 0%, #ec4899 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(249, 115, 22, 0.3);
        }
        
        .rail-item svg {
            width: 22px;
            height: 22px;
        }
        
        .rail-badge {
            position: absolute;
            top: 6px;
            right: 6px;
            min-width: 18px;
            height: 18px;
            background: #ef4444;
            border-radius: 9px;
            font-size: 10px;
            font-weight: 600;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            border: 2px solid #1a1a2e;
            padding: 0 4px;
        }
        
        .rail-badge.show {
            display: flex;
        }
        
        /* Tooltip */
        .rail-item .tooltip {
            position: absolute;
            left: 60px;
            background: linear-gradient(135deg, #1a1a2e 0%, #2d2d44 100%);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 13px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateX(-10px);
            transition: all 0.2s ease;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            z-index: 1000;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .rail-item .tooltip::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 50%;
            transform: translateY(-50%);
            border: 6px solid transparent;
            border-right-color: #1a1a2e;
        }
        
        .rail-item:hover .tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }
        
        .tooltip-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .tooltip-desc {
            font-size: 12px;
            color: #9ca3af;
        }
        
        .rail-divider {
            width: 32px;
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 12px 0;
            flex-shrink: 0;
        }
        
        .rail-bottom {
            margin-top: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.05);
        }
        
        .rail-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
        }
        
        .status-wrapper {
            position: relative;
        }
        
        .status-dot {
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 12px;
            height: 12px;
            background: #fbbf24;
            border-radius: 50%;
            border: 2px solid #1a1a2e;
        }
        
        .status-dot.connected {
            background: #10b981;
        }
        
        /* Expanded Panel */
        .expanded-panel {
            width: 240px;
            background: #fafafa;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .panel-header {
            padding: 20px 16px 16px;
            background: white;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .panel-header h2 {
            font-size: 16px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 2px;
        }
        
        .panel-header p {
            font-size: 12px;
            color: #6b7280;
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px 8px;
        }
        
        .menu-group {
            margin-bottom: 16px;
        }
        
        .menu-group:empty,
        .menu-group:has([data-menu-section]:empty) {
            display: none;
        }
        
        .menu-group-title {
            font-size: 10px;
            font-weight: 600;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 8px 12px 6px;
        }
        
        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 10px;
            color: #4b5563;
            cursor: pointer;
            transition: all 0.15s ease;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 2px;
            position: relative;
            text-decoration: none;
        }
        
        .sidebar-item:hover {
            background: white;
            color: #111827;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        
        .sidebar-item.active {
            background: white;
            color: #f97316;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        
        .sidebar-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 20px;
            background: linear-gradient(180deg, #f97316 0%, #ec4899 100%);
            border-radius: 0 3px 3px 0;
        }
        
        .sidebar-item svg {
            width: 18px;
            height: 18px;
            opacity: 0.7;
            flex-shrink: 0;
        }
        
        .sidebar-item.active svg {
            opacity: 1;
        }
        
        .menu-badge {
            margin-left: auto;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            background: #fef2f2;
            color: #dc2626;
        }
        
        .menu-badge.green {
            background: #f0fdf4;
            color: #16a34a;
        }
        
        .menu-badge.blue {
            background: #eff6ff;
            color: #2563eb;
        }
        
        .menu-badge.orange {
            background: #fff7ed;
            color: #ea580c;
        }
        
        /* User section */
        .panel-user {
            padding: 12px;
            background: white;
            border-top: 1px solid #f3f4f6;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .panel-user-info {
            flex: 1;
            min-width: 0;
        }
        
        .panel-user-info h4 {
            font-size: 13px;
            font-weight: 600;
            color: #111827;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .panel-user-status {
            font-size: 11px;
            color: #6b7280;
        }
        
        .panel-user-status.connected {
            color: #10b981;
        }
        
        .panel-user-action {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.15s;
            background: none;
            border: none;
        }
        
        .panel-user-action:hover {
            background: #f3f4f6;
            color: #4b5563;
        }
        
        /* =====================================================
           MOBILE MENU BUTTON
           ===================================================== */
        .mobile-menu-btn {
            display: none;
            width: 44px;
            height: 44px;
            padding: 10px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 8px;
            flex-shrink: 0;
        }
        
        .mobile-menu-btn:hover { background: rgba(0,0,0,0.05); }
        
        .mobile-menu-btn span {
            display: block;
            width: 22px;
            height: 2px;
            background: #333;
            margin: 5px auto;
            transition: all 0.3s;
            border-radius: 2px;
        }
        
        .mobile-menu-btn.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .mobile-menu-btn.active span:nth-child(2) {
            opacity: 0;
        }
        .mobile-menu-btn.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }
        
        /* =====================================================
           OVERLAY
           ===================================================== */
        .sidebar-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 40;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .sidebar-overlay.active {
            opacity: 1;
        }
        
        /* =====================================================
           RESPONSIVE - Tablet & Mobile
           ===================================================== */
        @media (max-width: 1023px) {
            .mobile-menu-btn {
                display: block;
            }
            
            .sidebar-overlay {
                display: block;
                pointer-events: none;
            }
            
            .sidebar-overlay.active {
                pointer-events: auto;
            }
            
            #sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 50;
                transform: translateX(-100%);
            }
            
            #sidebar.open {
                transform: translateX(0);
            }
            
            /* Hide expanded panel on mobile, show only icon rail */
            .expanded-panel {
                display: none;
            }
            
            #sidebar.open .expanded-panel {
                display: flex;
            }
            
            /* Header spacing */
            header {
                padding-left: 8px !important;
            }
        }
        
        /* Small screens - only show expanded panel */
        @media (max-width: 767px) {
            .icon-rail {
                display: none;
            }
            
            #sidebar.open .icon-rail {
                display: none;
            }
            
            #sidebar.open .expanded-panel {
                width: 280px;
            }
        }
        
        /* =====================================================
           RESPONSIVE - Mobile specific
           ===================================================== */
        @media (max-width: 767px) {
            /* Smaller header */
            header h1 { font-size: 1.25rem !important; }
            header p { font-size: 0.75rem !important; }
            
            /* Stack header buttons */
            #header-right {
                gap: 8px !important;
            }
            
            #header-right button {
                padding: 8px !important;
                font-size: 14px !important;
            }
            
            #header-right button span.hide-mobile {
                display: none;
            }
            
            /* Smaller padding on main content */
            #main-content {
                padding: 12px !important;
            }
            
            /* Cards full width */
            .card {
                border-radius: 12px;
            }
            
            /* Touch-friendly buttons */
            button, a.btn, .btn {
                min-height: 44px;
            }
            
            /* Prevent zoom on input focus */
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* =====================================================
           RESPONSIVE - Small mobile
           ===================================================== */
        @media (max-width: 479px) {
            header {
                flex-wrap: wrap;
                gap: 8px;
            }
            
            #header-right {
                width: 100%;
                justify-content: flex-end;
            }
        }
        
        /* =====================================================
           RESPONSIVE TABLES (auto-apply)
           ===================================================== */
        @media (max-width: 767px) {
            table.responsive-table {
                display: block;
            }
            
            table.responsive-table thead {
                display: none;
            }
            
            table.responsive-table tbody {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
            
            table.responsive-table tr {
                display: block;
                background: white;
                border-radius: 12px;
                padding: 16px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            }
            
            table.responsive-table td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 8px 0;
                border: none !important;
                border-bottom: 1px solid #f1f5f9 !important;
            }
            
            table.responsive-table td:last-child {
                border-bottom: none !important;
            }
            
            table.responsive-table td::before {
                content: attr(data-label);
                font-weight: 600;
                color: #64748b;
                flex-shrink: 0;
                margin-right: 12px;
            }
        }
        
        /* =====================================================
           RESPONSIVE MODALS
           ===================================================== */
        @media (max-width: 767px) {
            .modal-content,
            [class*="modal"] > div {
                width: 100% !important;
                max-width: 100% !important;
                height: 100% !important;
                max-height: 100% !important;
                border-radius: 0 !important;
                margin: 0 !important;
            }
        }
        
        /* =====================================================
           RESPONSIVE GRIDS
           ===================================================== */
        @media (max-width: 767px) {
            .grid-cols-2,
            .grid-cols-3,
            .grid-cols-4,
            .md\:grid-cols-2,
            .md\:grid-cols-3,
            .md\:grid-cols-4,
            .lg\:grid-cols-2,
            .lg\:grid-cols-3,
            .lg\:grid-cols-4 {
                grid-template-columns: 1fr !important;
            }
            
            /* Stats can be 2 columns */
            .stats-grid,
            .grid.gap-4:has(> :nth-child(4)) {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }
        
        /* =====================================================
           UTILITY CLASSES
           ===================================================== */
        .hide-mobile { display: block; }
        .show-mobile { display: none; }
        
        @media (max-width: 767px) {
            .hide-mobile { display: none !important; }
            .show-mobile { display: block !important; }
        }
        
        /* Safe area padding for notch devices */
        @supports (padding: max(0px)) {
            #sidebar {
                padding-top: max(0px, env(safe-area-inset-top));
                padding-bottom: max(0px, env(safe-area-inset-bottom));
            }
        }
        
        /* Smooth transitions */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Loading spinner */
        .spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Sidebar Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>
    
    <div id="app" class="flex h-screen">
        <!-- SIDEBAR - Icon Rail + Expanded Panel -->
        <aside id="sidebar" class="sidebar-container flex flex-shrink-0">
            <!-- Icon Rail -->
            <div class="icon-rail">
                <div class="rail-logo">A</div>
                
                <div class="rail-section">
                    <!-- Dashboard -->
                    <div class="rail-item active" data-category="dashboard" title="Dashboard">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                        <div class="tooltip">
                            <div class="tooltip-title">Dashboard</div>
                            <div class="tooltip-desc">Prehƒæad a ≈°tatistiky</div>
                        </div>
                    </div>
                    
                    <!-- CRM -->
                    <div class="rail-item" data-category="crm" title="CRM">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        <span class="rail-badge" id="badge-crm"></span>
                        <div class="tooltip">
                            <div class="tooltip-title">CRM</div>
                            <div class="tooltip-desc">Leady, Klienti, Projekty</div>
                        </div>
                    </div>
                    
                    <!-- Marketing -->
                    <div class="rail-item" data-category="marketing" title="Marketing">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m3 11 18-5v12L3 14v-3z"/><path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"/></svg>
                        <div class="tooltip">
                            <div class="tooltip-title">Marketing</div>
                            <div class="tooltip-desc">Kampane, Onboarding</div>
                        </div>
                    </div>
                    
                    <div class="rail-divider"></div>
                    
                    <!-- Komunik√°cia -->
                    <div class="rail-item" data-category="communication" title="Komunik√°cia">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        <span class="rail-badge" id="badge-communication"></span>
                        <div class="tooltip">
                            <div class="tooltip-title">Komunik√°cia</div>
                            <div class="tooltip-desc">Spr√°vy, Tickety</div>
                        </div>
                    </div>
                    
                    <!-- Produktivita -->
                    <div class="rail-item" data-category="productivity" title="Produktivita">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
                        <span class="rail-badge" id="badge-productivity"></span>
                        <div class="tooltip">
                            <div class="tooltip-title">Produktivita</div>
                            <div class="tooltip-desc">√ölohy, Kalend√°r</div>
                        </div>
                    </div>
                    
                    <div class="rail-divider"></div>
                    
                    <!-- Financie -->
                    <div class="rail-item" data-category="finance" title="Financie">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                        <div class="tooltip">
                            <div class="tooltip-title">Financie</div>
                            <div class="tooltip-desc">Faktur√°cia, Reporty</div>
                        </div>
                    </div>
                    
                    <!-- Konfigur√°cia -->
                    <div class="rail-item" data-category="config" title="Konfigur√°cia">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/></svg>
                        <div class="tooltip">
                            <div class="tooltip-title">Konfigur√°cia</div>
                            <div class="tooltip-desc">Slu≈æby, Bal√≠ƒçky, ≈†abl√≥ny</div>
                        </div>
                    </div>
                </div>
                
                <div class="rail-bottom">
                    <div class="rail-item" data-category="settings" title="Nastavenia">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                        <div class="tooltip">
                            <div class="tooltip-title">Nastavenia</div>
                            <div class="tooltip-desc">Syst√©m, T√≠m, Integr√°cie</div>
                        </div>
                    </div>
                    
                    <div class="status-wrapper">
                        <div id="user-avatar" class="rail-avatar">U</div>
                        <div class="status-dot" id="connection-dot"></div>
                    </div>
                </div>
            </div>
            
            <!-- Expanded Panel -->
            <div class="expanded-panel">
                <div class="panel-header">
                    <h2 id="panel-title">Dashboard</h2>
                    <p id="panel-subtitle">Prehƒæad va≈°ej aktivity</p>
                </div>
                
                <div class="panel-content">
                    <!-- Prehƒæad -->
                    <div class="menu-group" data-menu-category="dashboard">
                        <div class="menu-group-title">Prehƒæad</div>
                        <div data-menu-section="dashboard"></div>
                    </div>
                    
                    <!-- CRM -->
                    <div class="menu-group" data-menu-category="crm">
                        <div class="menu-group-title">CRM</div>
                        <div data-menu-section="crm"></div>
                    </div>
                    
                    <!-- Marketing -->
                    <div class="menu-group" data-menu-category="marketing">
                        <div class="menu-group-title">Marketing</div>
                        <div data-menu-section="marketing"></div>
                    </div>
                    
                    <!-- Komunik√°cia -->
                    <div class="menu-group" data-menu-category="communication">
                        <div class="menu-group-title">Komunik√°cia</div>
                        <div data-menu-section="communication"></div>
                    </div>
                    
                    <!-- Produktivita -->
                    <div class="menu-group" data-menu-category="productivity">
                        <div class="menu-group-title">Produktivita</div>
                        <div data-menu-section="productivity"></div>
                    </div>
                    
                    <!-- Financie -->
                    <div class="menu-group" data-menu-category="finance">
                        <div class="menu-group-title">Financie</div>
                        <div data-menu-section="finance"></div>
                    </div>
                    
                    <!-- Konfigur√°cia -->
                    <div class="menu-group" data-menu-category="config">
                        <div class="menu-group-title">Konfigur√°cia</div>
                        <div data-menu-section="config"></div>
                    </div>
                    
                    <!-- Nastavenia -->
                    <div class="menu-group" data-menu-category="settings">
                        <div class="menu-group-title">Syst√©m</div>
                        <div data-menu-section="settings"></div>
                    </div>
                </div>
                
                <div class="panel-user">
                    <div class="panel-user-avatar" id="user-avatar-panel">U</div>
                    <div class="panel-user-info">
                        <h4 id="user-name">Naƒç√≠tavam...</h4>
                        <span id="connection-status" class="panel-user-status">Prip√°jam...</span>
                    </div>
                    <button data-action="logout" class="panel-user-action" title="Odhl√°si≈•">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                    </button>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- TOP BAR -->
            <header class="bg-white border-b px-4 lg:px-6 py-3 lg:py-4 flex items-center justify-between flex-shrink-0 gap-2">
                <!-- Mobile menu button + Title -->
                <div class="flex items-center gap-2 min-w-0">
                    <button id="mobile-menu-btn" class="mobile-menu-btn" aria-label="Menu" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <div class="min-w-0">
                        <h1 id="page-title" class="text-xl lg:text-2xl font-bold text-gray-800 truncate">Dashboard</h1>
                        <p id="page-subtitle" class="text-xs lg:text-sm text-gray-500 truncate">Prehƒæad</p>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="flex items-center gap-2 lg:gap-3 flex-shrink-0" id="header-right">
                    <button onclick="location.reload()" class="p-2 lg:px-4 lg:py-2 bg-gray-100 rounded-xl hover:bg-gray-200 text-sm font-medium" title="Obnovi≈•">
                        üîÑ <span class="hide-mobile">Obnovi≈•</span>
                    </button>
                    <button onclick="Router.navigate('settings')" class="p-2 lg:px-4 lg:py-2 bg-gray-100 rounded-xl hover:bg-gray-200 text-sm font-medium" title="Nastavenia">
                        ‚öôÔ∏è
                    </button>
                    <!-- Notifications bell will be inserted here -->
                </div>
            </header>

            <!-- PAGE CONTENT -->
            <main id="main-content" class="flex-1 overflow-y-auto p-4 lg:p-6">
                <div class="flex items-center justify-center h-64">
                    <div class="animate-spin text-4xl">‚è≥</div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Core Scripts -->
    <script src="../shared/js/core/config.js"></script>
    <script src="../shared/js/core/database.js"></script>
    <script src="../shared/js/core/auth.js"></script>
    <script src="../shared/js/core/router.js"></script>
    <script src="../shared/js/core/utils.js"></script>
    <script src="../shared/js/utils/pdf-generator.js"></script>
    <script src="../shared/js/core/app.js"></script>
    <script src="../shared/js/components/notifications.js"></script>
    
    <!-- Module Scripts -->
    <script src="../modules/dashboard/dashboard.js"></script>
    <script src="../modules/leads/leads.js"></script>
    <script src="../modules/clients/clients.js"></script>
    <script src="../modules/messages/messages.js"></script>
    <script src="../modules/projects/projects.js"></script>
    <script src="../modules/campaigns/campaigns.js"></script>
    <script src="../modules/onboarding/onboarding.js"></script>
    
    <!-- Onboarding Components -->
    <script src="../modules/onboarding/components/PlatformSelector.js"></script>
    <script src="../modules/onboarding/components/PackageCalculator.js"></script>
    <script src="../modules/onboarding/components/AccountHealthCheck.js"></script>
    
    <!-- Onboarding Extension (must be after base module and components) -->
    <script src="../modules/onboarding/onboarding-extension.js"></script>
    <script src="../modules/services/services.js"></script>
    <script src="../modules/billing/billing.js"></script>
    <script src="../modules/settings/settings.js"></script>
    <script src="../modules/integrations/integrations.js"></script>
    <script src="../modules/team/team.js"></script>
    <script src="../modules/tasks/tasks.js"></script>
    <script src="../modules/tickets/tickets.js"></script>
    <script src="../modules/reporting/reporting.js"></script>
    <script src="../modules/calendar/calendar.js"></script>
    <script src="../modules/templates/templates.js"></script>
    <script src="../modules/documents/documents.js"></script>
    <script src="../modules/keywords/keywords.js"></script>
    <script src="../modules/automations/automations.js"></script>
    
    <!-- Mobile Menu Handler -->
    <script>
    (function() {
        'use strict';
        
        // Elements
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        const menuBtn = document.getElementById('mobile-menu-btn');
        
        // Fix viewport height for mobile browsers
        function setVH() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        setVH();
        window.addEventListener('resize', setVH);
        window.addEventListener('orientationchange', () => setTimeout(setVH, 100));
        
        // Toggle menu
        function toggleMenu() {
            const isOpen = sidebar.classList.toggle('open');
            overlay.classList.toggle('active', isOpen);
            menuBtn.classList.toggle('active', isOpen);
            menuBtn.setAttribute('aria-expanded', isOpen);
            document.body.style.overflow = isOpen ? 'hidden' : '';
        }
        
        // Close menu
        function closeMenu() {
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            menuBtn.classList.remove('active');
            menuBtn.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = '';
        }
        
        // Event listeners
        menuBtn.addEventListener('click', toggleMenu);
        overlay.addEventListener('click', closeMenu);
        
        // Close on menu item click
        sidebar.addEventListener('click', (e) => {
            if (e.target.closest('.sidebar-item') && window.innerWidth < 1024) {
                closeMenu();
            }
        });
        
        // Close on Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeMenu();
        });
        
        // Close on resize to desktop
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) closeMenu();
        });
        
        // Swipe to open/close
        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        }, { passive: true });
        
        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const deltaX = touchEndX - touchStartX;
            
            // Swipe right from edge to open
            if (deltaX > 50 && touchStartX < 30 && !sidebar.classList.contains('open')) {
                toggleMenu();
            }
            // Swipe left to close
            if (deltaX < -50 && sidebar.classList.contains('open')) {
                closeMenu();
            }
        }, { passive: true });
        
        // Make tables responsive dynamically
        const observer = new MutationObserver(() => {
            document.querySelectorAll('table:not(.responsive-table)').forEach(table => {
                table.classList.add('responsive-table');
                const headers = Array.from(table.querySelectorAll('thead th')).map(th => th.textContent.trim());
                table.querySelectorAll('tbody tr').forEach(row => {
                    row.querySelectorAll('td').forEach((cell, i) => {
                        if (headers[i]) cell.setAttribute('data-label', headers[i]);
                    });
                });
            });
        });
        observer.observe(document.getElementById('main-content'), { childList: true, subtree: true });
        
        console.log('üì± Mobile ready');
    })();
    </script>
    
    <!-- Initialize App -->
    <script>
        (async () => {
            const success = await App.init({ requireTeam: true });
            
            if (success) {
                // Initialize Notifications
                if (typeof Notifications !== 'undefined') {
                    Notifications.init();
                }
                
                // Register modules - HLAVN√â
                App.register(DashboardModule);
                App.register(LeadsModule);
                App.register(ClientsModule);
                App.register(CampaignProjectsModule);
                App.register(CampaignsModule);
                App.register(MessagesModule);
                App.register(TasksModule);
                App.register(TicketsModule);
                App.register(BillingModule);
                
                // Register modules - N√ÅSTROJE
                App.register(OnboardingModule);
                App.register(ServicesModule);
                App.register(ReportingModule);
                App.register(CalendarModule);
                App.register(TemplatesModule);
                App.register(DocumentsModule);
                App.register(KeywordResearchModule);
                App.register(AutomationsModule);
                
                // Register modules - SYST√âM
                App.register(SettingsModule);
                App.register(IntegrationsModule);
                App.register(TeamModule);
                
                // Navigate to default or current route
                if (!window.location.hash) {
                    Router.navigate('dashboard');
                }
            }
        })();
    </script>
</body>
</html>
